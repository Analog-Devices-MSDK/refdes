<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FaceIdScenariosFragment.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.maximintegrated.maxcamandroid.faceId</a> &gt; <span class="el_source">FaceIdScenariosFragment.kt</span></div><h1>FaceIdScenariosFragment.kt</h1><pre class="source lang-java linenums">package com.maximintegrated.maxcamandroid.faceId


import androidx.appcompat.app.AlertDialog
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.view.isInvisible
import androidx.core.view.isVisible
import androidx.fragment.app.Fragment
import androidx.lifecycle.ViewModelProviders
import androidx.lifecycle.observe
import androidx.recyclerview.widget.RecyclerView
import com.maximintegrated.maxcamandroid.MainActivity
import com.maximintegrated.maxcamandroid.R
import com.maximintegrated.maxcamandroid.exts.addFragment
import kotlinx.android.synthetic.main.activity_main.*
import kotlinx.android.synthetic.main.edit_text_alert_dialog.view.*
import kotlinx.android.synthetic.main.fragment_face_id_scenarios.*
import timber.log.Timber


/**
 * A simple [Fragment] subclass.
 */
<span class="fc" id="L27">class FaceIdScenariosFragment : Fragment(), ScenarioListener {</span>

    companion object {
<span class="fc" id="L30">        fun newInstance() = FaceIdScenariosFragment()</span>
    }

    private lateinit var faceIdViewModel: FaceIdViewModel
    private lateinit var scenarioAdapter: FaceIdScenarioAdapter

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        // Inflate the layout for this fragment
<span class="fc" id="L41">        return inflater.inflate(R.layout.fragment_face_id_scenarios, container, false)</span>
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
<span class="fc" id="L45">        super.onViewCreated(view, savedInstanceState)</span>
<span class="pc bpc" id="L46" title="3 of 6 branches missed.">        (requireActivity() as? MainActivity)?.mainFab?.isInvisible = true</span>
<span class="fc" id="L47">        faceIdViewModel = ViewModelProviders.of(requireActivity()).get(FaceIdViewModel::class.java)</span>
<span class="fc" id="L48">        scenarioAdapter = FaceIdScenarioAdapter(this)</span>
<span class="fc" id="L49">        recyclerView.adapter = scenarioAdapter</span>
<span class="fc" id="L50">        faceIdViewModel.scenarios.observe(viewLifecycleOwner) {</span>
            Timber.d(it.joinToString(&quot;, &quot;))
            scenarioAdapter.scenarios = it
            emptyViews.isVisible = it.isEmpty()
            recyclerView.isVisible = it.isNotEmpty()
        }
<span class="fc" id="L56">        faceIdViewModel.getScenarioList()</span>

<span class="fc" id="L58">        newScenarioFab.setOnClickListener {</span>
<span class="fc" id="L59">            showNewScenarioDialog()</span>
<span class="fc" id="L60">        }</span>

<span class="fc" id="L62">        recyclerView.addOnScrollListener(object : RecyclerView.OnScrollListener() {</span>
            override fun onScrolled(recyclerView: RecyclerView, dx: Int, dy: Int) {
<span class="fc bfc" id="L64" title="All 4 branches covered.">                if (dy &lt; 0 &amp;&amp; !newScenarioFab.isShown)</span>
<span class="fc" id="L65">                    newScenarioFab.show()</span>
<span class="fc bfc" id="L66" title="All 4 branches covered.">                else if (dy &gt; 0 &amp;&amp; newScenarioFab.isShown)</span>
<span class="fc" id="L67">                    newScenarioFab.hide()</span>
<span class="fc" id="L68">            }</span>

        })
<span class="fc" id="L71">    }</span>

    override fun onEditButtonClicked(scenario: Scenario) {
<span class="fc" id="L74">        requireActivity().addFragment(FaceIdInputParamsFragment.newInstance())</span>
<span class="fc" id="L75">        faceIdViewModel.onScenarioSelectedWithEditOption(scenario)</span>
<span class="fc" id="L76">    }</span>

    override fun onSelectButtonClicked(scenario: Scenario) {
<span class="fc" id="L79">        requireActivity().addFragment(FaceIdUpdateDeviceFragment.newInstance())</span>
<span class="fc" id="L80">        faceIdViewModel.onScenarioSelected(scenario)</span>
<span class="fc" id="L81">    }</span>

    override fun onDeleteButtonClicked(scenario: Scenario) {
<span class="fc" id="L84">        faceIdViewModel.onScenarioDeleted(scenario)</span>
<span class="fc" id="L85">        newScenarioFab.show()</span>
<span class="fc" id="L86">    }</span>

    private fun showNewScenarioDialog() {
<span class="fc" id="L89">        val alert = AlertDialog.Builder(requireContext())</span>
<span class="fc" id="L90">        val layout = layoutInflater.inflate(R.layout.edit_text_alert_dialog, null)</span>
<span class="fc" id="L91">        alert.setView(layout)</span>
<span class="fc" id="L92">        alert.setPositiveButton(getString(R.string.create)) { dialog, _ -&gt;</span>
<span class="fc" id="L93">            val name = layout.dialogEditText.text.toString()</span>
<span class="fc" id="L94">            faceIdViewModel.addNewScenario(name)</span>
<span class="fc" id="L95">            requireActivity().addFragment(FaceIdInputParamsFragment.newInstance())</span>
<span class="fc" id="L96">            dialog.dismiss()</span>
<span class="fc" id="L97">        }</span>
<span class="fc" id="L98">        alert.show()</span>
<span class="fc" id="L99">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>